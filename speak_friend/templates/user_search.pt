<metal:main use-macro="load: base.pt">
    <metal:extend-js fill-slot="extend-js">
    <script src="${request.static_url('deform_bootstrap:static/deform_bootstrap.js')}"></script>
    <script>
        deform.load()
    </script>
    </metal:extend-js>
    <metal:title fill-slot="page-title">Find Users</metal:title>
    
    <metal:sub fill-slot="subnav">
        <metal:nav use-macro="api.macros['admin_nav']" />
    </metal:sub>
    
    <metal:content metal:fill-slot="content">
        <div tal:content="structure rendered_form">form</div>
          <tal:has_results tal:condition="results"
            tal:define="item_label len(results) > 1 and 'users' or 'user'">
          <h2>Results</h2>
          <p tal:condition="ran_search">We found ${len(results)} ${item_label} matching your query:</p>
          <table class="table table-striped table-bordered table-hover table-condensed">
            <tr>
              <th>Username</th>
              <th>First Name</th>
              <th>Last Name</th>
              <th>Actions</th>
              <th>Email Address</th>
            </tr>
            <tr tal:repeat="result results">
              <td>${result.username}</td>
              <td>${result.first_name}</td>
              <td>${result.last_name}</td>
              <td>
                  <a tal:attributes="href request.route_url('edit_profile', username=result.username)">Edit Profile</a> | 
                  <a tal:attributes="href request.route_url('request_user_password', username=result.username)">Reset Password</a> | 
                  <a tal:condition="not result.admin_disabled" tal:attributes="href request.route_url('disable_user', username=result.username);
                      class string:overlay;">Disable User</a>
              </td>
              <td>${result.email}</td>
            </tr>
          </table>
          </tal:has_results>
          <tal:no_results tal:condition="not results">
          <p>There were no results matching your search</p>
          </tal:no_results>
    </metal:content>
</metal:main>
